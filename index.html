<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#0a0a0f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">
<link rel="manifest" href="manifest.json">
<title>GRIND ‚Äî Workout Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #0a0a0f;
  --surface: #14141f;
  --surface2: #1e1e2e;
  --surface3: #2a2a3e;
  --text: #eeeef2;
  --text-dim: #8888a0;
  --accent: #ff5e3a;
  --accent2: #ff2d78;
  --accent-glow: rgba(255, 94, 58, 0.3);
  --cardio: #ff5e3a;
  --weights-upper: #7c5cff;
  --weights-lower: #5ca0ff;
  --yoga: #2dd4a8;
  --wellness: #ffc233;
  --radius: 16px;
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

html, body {
  height: 100%;
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
  touch-action: pan-y;
}

/* ‚îÄ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ‚îÄ */
.app {
  display: flex;
  flex-direction: column;
  height: 100dvh;
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
}

.app-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 20px 8px;
  flex-shrink: 0;
}

.app-logo {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 28px;
  letter-spacing: 4px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.header-stats {
  display: flex;
  gap: 12px;
  align-items: center;
}

.xp-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  background: var(--surface2);
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
}

.xp-badge .icon { font-size: 14px; }

.streak-badge {
  display: flex;
  align-items: center;
  gap: 4px;
  background: linear-gradient(135deg, rgba(255,94,58,0.2), rgba(255,45,120,0.2));
  border: 1px solid rgba(255,94,58,0.3);
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  color: var(--accent);
}

/* ‚îÄ‚îÄ‚îÄ VIEWS ‚îÄ‚îÄ‚îÄ */
.view-container {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0 16px 16px;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}

.view-container::-webkit-scrollbar { display: none; }

/* ‚îÄ‚îÄ‚îÄ NAV ‚îÄ‚îÄ‚îÄ */
.bottom-nav {
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 10px 0 12px;
  background: var(--surface);
  border-top: 1px solid rgba(255,255,255,0.05);
  flex-shrink: 0;
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  background: none;
  border: none;
  color: var(--text-dim);
  font-size: 10px;
  font-family: inherit;
  font-weight: 600;
  cursor: pointer;
  padding: 4px 16px;
  transition: color 0.2s;
}

.nav-item svg { width: 24px; height: 24px; }
.nav-item.active { color: var(--accent); }
.nav-item.active svg { filter: drop-shadow(0 0 6px var(--accent-glow)); }

.nav-item.log-btn {
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  color: white;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  margin-top: -28px;
  padding: 0;
  box-shadow: 0 4px 20px rgba(255,94,58,0.4);
  justify-content: center;
  font-size: 0;
}

.nav-item.log-btn svg { width: 28px; height: 28px; }

.view { display: none; }
.view.active { display: block; }

/* ‚îÄ‚îÄ‚îÄ QUICK LOG CARD ‚îÄ‚îÄ‚îÄ */
.section-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 20px;
  letter-spacing: 2px;
  color: var(--text-dim);
  margin: 16px 0 10px;
}

.quick-log-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 16px;
}

.category-card {
  position: relative;
  background: var(--surface);
  border-radius: var(--radius);
  padding: 16px;
  cursor: pointer;
  border: 2px solid transparent;
  transition: all 0.25s ease;
  overflow: hidden;
}

.category-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
  background: var(--cat-color);
  opacity: 0.7;
}

.category-card:active {
  transform: scale(0.96);
  border-color: var(--cat-color);
}

.category-card .card-icon {
  font-size: 28px;
  margin-bottom: 8px;
  display: block;
}

.category-card .card-label {
  font-weight: 600;
  font-size: 14px;
  margin-bottom: 2px;
}

.category-card .card-sub {
  font-size: 11px;
  color: var(--text-dim);
}

/* ‚îÄ‚îÄ‚îÄ CALENDAR HEATMAP ‚îÄ‚îÄ‚îÄ */
.cal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.cal-nav {
  display: flex;
  gap: 8px;
}

.cal-nav button {
  background: var(--surface2);
  border: none;
  color: var(--text);
  width: 32px;
  height: 32px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cal-month {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 18px;
  letter-spacing: 2px;
}

.cal-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
  margin-bottom: 16px;
}

.cal-day-label {
  text-align: center;
  font-size: 10px;
  color: var(--text-dim);
  font-weight: 600;
  padding: 4px 0;
}

.cal-day {
  aspect-ratio: 1;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-dim);
  background: var(--surface);
  cursor: pointer;
  position: relative;
  transition: all 0.2s;
}

.cal-day.empty { background: transparent; cursor: default; }
.cal-day.today { border: 2px solid var(--accent); color: var(--text); }

.cal-day.has-activity {
  color: var(--text);
  font-weight: 700;
}

.cal-day.intensity-1 { background: rgba(255,94,58,0.15); }
.cal-day.intensity-2 { background: rgba(255,94,58,0.3); }
.cal-day.intensity-3 { background: rgba(255,94,58,0.5); }
.cal-day.intensity-4 { background: linear-gradient(135deg, rgba(255,94,58,0.7), rgba(255,45,120,0.5)); }

/* ‚îÄ‚îÄ‚îÄ STATS ‚îÄ‚îÄ‚îÄ */
.stat-row {
  display: flex;
  gap: 10px;
  margin-bottom: 12px;
}

.stat-card {
  flex: 1;
  background: var(--surface);
  border-radius: var(--radius);
  padding: 16px;
  text-align: center;
}

.stat-number {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 36px;
  line-height: 1;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.stat-label {
  font-size: 11px;
  color: var(--text-dim);
  font-weight: 600;
  margin-top: 4px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* ‚îÄ‚îÄ‚îÄ CATEGORY BREAKDOWN BARS ‚îÄ‚îÄ‚îÄ */
.breakdown-item {
  margin-bottom: 14px;
}

.breakdown-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.breakdown-label {
  font-size: 13px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.breakdown-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  display: inline-block;
}

.breakdown-count {
  font-size: 12px;
  color: var(--text-dim);
}

.breakdown-bar-bg {
  height: 8px;
  background: var(--surface2);
  border-radius: 4px;
  overflow: hidden;
}

.breakdown-bar {
  height: 100%;
  border-radius: 4px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

/* ‚îÄ‚îÄ‚îÄ ACHIEVEMENTS ‚îÄ‚îÄ‚îÄ */
.achievements-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-bottom: 16px;
}

.achievement {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 14px 10px;
  text-align: center;
  transition: all 0.3s;
}

.achievement.locked {
  opacity: 0.35;
  filter: grayscale(1);
}

.achievement.unlocked {
  border: 1px solid rgba(255,194,51,0.3);
  background: linear-gradient(135deg, var(--surface), rgba(255,194,51,0.08));
}

.achievement .badge-icon {
  font-size: 32px;
  display: block;
  margin-bottom: 6px;
}

.achievement .badge-name {
  font-size: 11px;
  font-weight: 700;
  margin-bottom: 2px;
}

.achievement .badge-desc {
  font-size: 9px;
  color: var(--text-dim);
}

/* ‚îÄ‚îÄ‚îÄ LEVEL PROGRESS ‚îÄ‚îÄ‚îÄ */
.level-bar-container {
  background: var(--surface);
  border-radius: var(--radius);
  padding: 16px;
  margin-bottom: 16px;
}

.level-info {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 10px;
}

.level-name {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 22px;
  letter-spacing: 2px;
}

.level-xp {
  font-size: 12px;
  color: var(--text-dim);
}

.level-bar-bg {
  height: 10px;
  background: var(--surface3);
  border-radius: 5px;
  overflow: hidden;
}

.level-bar-fill {
  height: 100%;
  border-radius: 5px;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 0 12px var(--accent-glow);
}

/* ‚îÄ‚îÄ‚îÄ LOG MODAL ‚îÄ‚îÄ‚îÄ */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  z-index: 100;
  display: none;
  align-items: flex-end;
  justify-content: center;
  animation: fadeIn 0.2s ease;
}

.modal-overlay.show { display: flex; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

.modal {
  background: var(--surface);
  border-radius: 24px 24px 0 0;
  width: 100%;
  max-width: 500px;
  max-height: 85dvh;
  overflow-y: auto;
  padding: 24px 20px 40px;
  animation: slideUp 0.3s ease;
}

.modal-handle {
  width: 40px;
  height: 4px;
  background: var(--surface3);
  border-radius: 2px;
  margin: 0 auto 20px;
}

.modal-title {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 24px;
  letter-spacing: 2px;
  margin-bottom: 20px;
}

.modal-categories {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 20px;
}

.modal-cat {
  background: var(--surface2);
  border: 2px solid transparent;
  border-radius: 12px;
  padding: 14px;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s;
  font-family: inherit;
  color: var(--text);
  font-size: 13px;
  font-weight: 600;
}

.modal-cat:active { transform: scale(0.96); }
.modal-cat.selected { border-color: var(--cat-color); background: rgba(255,255,255,0.05); }
.modal-cat .mc-icon { font-size: 24px; display: block; margin-bottom: 4px; }

.form-group { margin-bottom: 16px; }

.form-label {
  display: block;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
}

.form-input, .form-select, .form-textarea {
  width: 100%;
  background: var(--surface2);
  border: 1px solid var(--surface3);
  border-radius: 12px;
  padding: 12px 16px;
  color: var(--text);
  font-size: 15px;
  font-family: inherit;
  outline: none;
  transition: border-color 0.2s;
  -webkit-appearance: none;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
  border-color: var(--accent);
}

.form-textarea { resize: none; min-height: 60px; }

.duration-picker {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.dur-chip {
  background: var(--surface2);
  border: 2px solid transparent;
  border-radius: 20px;
  padding: 8px 16px;
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  cursor: pointer;
  font-family: inherit;
  transition: all 0.2s;
}

.dur-chip.selected {
  border-color: var(--accent);
  background: rgba(255,94,58,0.15);
  color: var(--accent);
}

.btn-save {
  width: 100%;
  padding: 16px;
  background: linear-gradient(135deg, var(--accent), var(--accent2));
  border: none;
  border-radius: 14px;
  color: white;
  font-size: 16px;
  font-weight: 700;
  font-family: inherit;
  cursor: pointer;
  letter-spacing: 1px;
  box-shadow: 0 4px 20px rgba(255,94,58,0.3);
  transition: transform 0.2s, opacity 0.2s;
}

.btn-save:active { transform: scale(0.97); }
.btn-save:disabled { opacity: 0.4; }

/* ‚îÄ‚îÄ‚îÄ RECENT LOG ‚îÄ‚îÄ‚îÄ */
.recent-item {
  display: flex;
  align-items: center;
  gap: 12px;
  background: var(--surface);
  border-radius: 12px;
  padding: 14px;
  margin-bottom: 8px;
}

.recent-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  flex-shrink: 0;
}

.recent-info { flex: 1; }

.recent-title {
  font-size: 14px;
  font-weight: 600;
}

.recent-meta {
  font-size: 11px;
  color: var(--text-dim);
  margin-top: 2px;
}

.recent-xp {
  font-size: 13px;
  font-weight: 700;
  color: var(--accent);
}

/* ‚îÄ‚îÄ‚îÄ EXPORT BTN ‚îÄ‚îÄ‚îÄ */
.export-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  padding: 14px;
  background: var(--surface);
  border: 1px solid var(--surface3);
  border-radius: 14px;
  color: var(--text);
  font-size: 14px;
  font-weight: 600;
  font-family: inherit;
  cursor: pointer;
  margin-bottom: 12px;
  transition: all 0.2s;
}

.export-btn:active { background: var(--surface2); }
.export-btn svg { width: 20px; height: 20px; }

/* ‚îÄ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ */
.toast {
  position: fixed;
  top: 60px;
  left: 50%;
  transform: translateX(-50%) translateY(-100px);
  background: var(--surface2);
  border: 1px solid var(--accent);
  color: var(--text);
  padding: 14px 24px;
  border-radius: 14px;
  font-size: 14px;
  font-weight: 600;
  z-index: 200;
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 8px 30px rgba(0,0,0,0.4);
  text-align: center;
  max-width: 90vw;
}

.toast.show { transform: translateX(-50%) translateY(0); }

/* ‚îÄ‚îÄ‚îÄ DAY DETAIL MODAL ‚îÄ‚îÄ‚îÄ */
.day-detail-header {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 20px;
  letter-spacing: 1px;
  margin-bottom: 16px;
}

.day-activity {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: var(--surface2);
  border-radius: 12px;
  margin-bottom: 8px;
}

.day-activity-icon {
  font-size: 24px;
}

.day-activity-info { flex: 1; }

.day-activity-name {
  font-weight: 600;
  font-size: 14px;
}

.day-activity-meta {
  font-size: 11px;
  color: var(--text-dim);
}

.day-activity-del {
  background: none;
  border: none;
  color: var(--text-dim);
  font-size: 18px;
  cursor: pointer;
  padding: 4px 8px;
}

/* ‚îÄ‚îÄ‚îÄ WEEK SELECTOR ‚îÄ‚îÄ‚îÄ */
.period-tabs {
  display: flex;
  background: var(--surface);
  border-radius: 10px;
  padding: 3px;
  margin-bottom: 16px;
}

.period-tab {
  flex: 1;
  padding: 8px;
  border: none;
  background: none;
  color: var(--text-dim);
  font-size: 12px;
  font-weight: 600;
  font-family: inherit;
  cursor: pointer;
  border-radius: 8px;
  transition: all 0.2s;
}

.period-tab.active {
  background: var(--surface3);
  color: var(--text);
}

/* ‚îÄ‚îÄ‚îÄ SETTINGS ‚îÄ‚îÄ‚îÄ */
.setting-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px;
  background: var(--surface);
  border-radius: 12px;
  margin-bottom: 8px;
}

.setting-label { font-size: 14px; font-weight: 500; }
.setting-desc { font-size: 11px; color: var(--text-dim); margin-top: 2px; }

.toggle {
  width: 48px;
  height: 28px;
  background: var(--surface3);
  border-radius: 14px;
  border: none;
  cursor: pointer;
  position: relative;
  transition: background 0.2s;
}

.toggle.on { background: var(--accent); }

.toggle::after {
  content: '';
  position: absolute;
  width: 22px;
  height: 22px;
  background: white;
  border-radius: 50%;
  top: 3px;
  left: 3px;
  transition: transform 0.2s;
}

.toggle.on::after { transform: translateX(20px); }

/* ‚îÄ‚îÄ‚îÄ Utilities ‚îÄ‚îÄ‚îÄ */
.mb-8 { margin-bottom: 8px; }
.mb-16 { margin-bottom: 16px; }
.text-center { text-align: center; }
.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-dim);
}
.empty-state .empty-icon { font-size: 48px; margin-bottom: 12px; display: block; }
.empty-state p { font-size: 14px; }

</style>
</head>
<body>

<div class="app">
  <!-- Header -->
  <header class="app-header">
    <div class="app-logo">GRIND</div>
    <div class="header-stats">
      <div class="streak-badge">
        <span>üî•</span>
        <span id="headerStreak">0</span>
      </div>
      <div class="xp-badge">
        <span class="icon">‚ö°</span>
        <span id="headerXP">0 XP</span>
      </div>
    </div>
  </header>

  <!-- View Container -->
  <div class="view-container" id="viewContainer">

    <!-- HOME VIEW -->
    <div class="view active" id="homeView">
      <div class="section-title">QUICK LOG</div>
      <div class="quick-log-grid">
        <div class="category-card" style="--cat-color: var(--cardio)" onclick="openLogModal('cardio')">
          <span class="card-icon">üèÉ</span>
          <div class="card-label">Cardio</div>
          <div class="card-sub">Running, cycling, HIIT</div>
        </div>
        <div class="category-card" style="--cat-color: var(--weights-upper)" onclick="openLogModal('weights-upper')">
          <span class="card-icon">üí™</span>
          <div class="card-label">Upper Body</div>
          <div class="card-sub">Chest, back, arms</div>
        </div>
        <div class="category-card" style="--cat-color: var(--weights-lower)" onclick="openLogModal('weights-lower')">
          <span class="card-icon">ü¶µ</span>
          <div class="card-label">Lower Body</div>
          <div class="card-sub">Squats, deadlifts, legs</div>
        </div>
        <div class="category-card" style="--cat-color: var(--yoga)" onclick="openLogModal('yoga')">
          <span class="card-icon">üßò</span>
          <div class="card-label">Yoga & Stretch</div>
          <div class="card-sub">Flexibility, mobility</div>
        </div>
        <div class="category-card" style="--cat-color: var(--wellness)" onclick="openLogModal('wellness')">
          <span class="card-icon">üß†</span>
          <div class="card-label">Wellness</div>
          <div class="card-sub">Meditation, recovery</div>
        </div>
        <div class="category-card" style="--cat-color: #e0e0e0" onclick="openLogModal('other')">
          <span class="card-icon">üéØ</span>
          <div class="card-label">Other</div>
          <div class="card-sub">Sports, hiking, etc.</div>
        </div>
      </div>

      <div class="section-title">RECENT ACTIVITIES</div>
      <div id="recentList"></div>
    </div>

    <!-- CALENDAR VIEW -->
    <div class="view" id="calendarView">
      <div class="cal-header">
        <div class="cal-nav">
          <button onclick="changeMonth(-1)">‚óÄ</button>
        </div>
        <div class="cal-month" id="calMonth"></div>
        <div class="cal-nav">
          <button onclick="changeMonth(1)">‚ñ∂</button>
        </div>
      </div>
      <div class="cal-grid" id="calGrid"></div>

      <button class="export-btn" onclick="exportToCalendar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
        Export to Calendar (.ics)
      </button>

      <div class="section-title">DAY DETAILS</div>
      <div id="dayDetail">
        <div class="empty-state">
          <span class="empty-icon">üìÖ</span>
          <p>Tap a day to see activities</p>
        </div>
      </div>
    </div>

    <!-- STATS VIEW -->
    <div class="view" id="statsView">
      <div class="period-tabs">
        <button class="period-tab active" onclick="setStatsPeriod('week', this)">Week</button>
        <button class="period-tab" onclick="setStatsPeriod('month', this)">Month</button>
        <button class="period-tab" onclick="setStatsPeriod('all', this)">All Time</button>
      </div>

      <div class="stat-row">
        <div class="stat-card">
          <div class="stat-number" id="statWorkouts">0</div>
          <div class="stat-label">Workouts</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="statMinutes">0</div>
          <div class="stat-label">Minutes</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="statStreak">0</div>
          <div class="stat-label">Day Streak</div>
        </div>
      </div>

      <div class="section-title">CATEGORY BREAKDOWN</div>
      <div id="breakdownContainer"></div>

      <div class="section-title">FOCUS BALANCE</div>
      <div class="stat-row mb-16">
        <div class="stat-card">
          <div class="stat-number" id="balUpper">0</div>
          <div class="stat-label">Upper Body</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="balLower">0</div>
          <div class="stat-label">Lower Body</div>
        </div>
      </div>
      <div class="stat-row mb-16">
        <div class="stat-card">
          <div class="stat-number" id="balCardio">0</div>
          <div class="stat-label">Cardio</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="balWellness">0</div>
          <div class="stat-label">Wellness</div>
        </div>
      </div>
    </div>

    <!-- ACHIEVEMENTS VIEW -->
    <div class="view" id="achieveView">
      <div class="level-bar-container">
        <div class="level-info">
          <div class="level-name" id="levelName">Level 1 ‚Äî Beginner</div>
          <div class="level-xp" id="levelXP">0 / 100 XP</div>
        </div>
        <div class="level-bar-bg">
          <div class="level-bar-fill" id="levelBar" style="width: 0%"></div>
        </div>
      </div>

      <div class="section-title">ACHIEVEMENTS</div>
      <div class="achievements-grid" id="achievementsGrid"></div>

      <div class="section-title">SETTINGS</div>
      <button class="export-btn" onclick="exportData()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        Export All Data (JSON)
      </button>
      <button class="export-btn" onclick="importData()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
        Import Data (JSON)
      </button>
      <input type="file" id="importFile" accept=".json" style="display:none" onchange="handleImport(event)">

      <button class="export-btn" style="color: #ff4444; border-color: rgba(255,68,68,0.3); margin-top: 16px;" onclick="clearAllData()">
        üóëÔ∏è Reset All Data
      </button>
    </div>
  </div>

  <!-- Bottom Nav -->
  <nav class="bottom-nav">
    <button class="nav-item active" onclick="switchView('homeView', this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      Home
    </button>
    <button class="nav-item" onclick="switchView('calendarView', this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
      Calendar
    </button>
    <button class="nav-item log-btn" onclick="openLogModal()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    </button>
    <button class="nav-item" onclick="switchView('statsView', this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
      Stats
    </button>
    <button class="nav-item" onclick="switchView('achieveView', this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
      Badges
    </button>
  </nav>
</div>

<!-- Log Modal -->
<div class="modal-overlay" id="logModal" onclick="if(event.target===this)closeLogModal()">
  <div class="modal">
    <div class="modal-handle"></div>
    <div class="modal-title">LOG ACTIVITY</div>

    <div class="modal-categories">
      <button class="modal-cat" style="--cat-color: var(--cardio)" data-cat="cardio" onclick="selectCat(this)">
        <span class="mc-icon">üèÉ</span>Cardio
      </button>
      <button class="modal-cat" style="--cat-color: var(--weights-upper)" data-cat="weights-upper" onclick="selectCat(this)">
        <span class="mc-icon">üí™</span>Upper Body
      </button>
      <button class="modal-cat" style="--cat-color: var(--weights-lower)" data-cat="weights-lower" onclick="selectCat(this)">
        <span class="mc-icon">ü¶µ</span>Lower Body
      </button>
      <button class="modal-cat" style="--cat-color: var(--yoga)" data-cat="yoga" onclick="selectCat(this)">
        <span class="mc-icon">üßò</span>Yoga
      </button>
      <button class="modal-cat" style="--cat-color: var(--wellness)" data-cat="wellness" onclick="selectCat(this)">
        <span class="mc-icon">üß†</span>Wellness
      </button>
      <button class="modal-cat" style="--cat-color: #e0e0e0" data-cat="other" onclick="selectCat(this)">
        <span class="mc-icon">üéØ</span>Other
      </button>
    </div>

    <div class="form-group">
      <label class="form-label">Activity Name</label>
      <input type="text" class="form-input" id="activityName" placeholder="e.g. Morning Run, Bench Press...">
    </div>

    <div class="form-group">
      <label class="form-label">Duration</label>
      <div class="duration-picker">
        <button class="dur-chip" onclick="selectDuration(this, 15)">15 min</button>
        <button class="dur-chip" onclick="selectDuration(this, 30)">30 min</button>
        <button class="dur-chip" onclick="selectDuration(this, 45)">45 min</button>
        <button class="dur-chip" onclick="selectDuration(this, 60)">60 min</button>
        <button class="dur-chip" onclick="selectDuration(this, 90)">90 min</button>
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">Date</label>
      <input type="date" class="form-input" id="activityDate">
    </div>

    <div class="form-group">
      <label class="form-label">Notes (optional)</label>
      <textarea class="form-textarea" id="activityNotes" placeholder="How did it feel?"></textarea>
    </div>

    <button class="btn-save" id="saveBtn" onclick="saveActivity()" disabled>SAVE ACTIVITY ‚ö°</button>
  </div>
</div>

<!-- Day Detail Modal -->
<div class="modal-overlay" id="dayModal" onclick="if(event.target===this)closeDayModal()">
  <div class="modal">
    <div class="modal-handle"></div>
    <div class="modal-title" id="dayModalTitle">DAY ACTIVITIES</div>
    <div id="dayModalContent"></div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
// ‚îÄ‚îÄ‚îÄ DATA LAYER ‚îÄ‚îÄ‚îÄ
const STORAGE_KEY = 'grind_data';
const CATEGORIES = {
  'cardio':        { icon: 'üèÉ', label: 'Cardio',      color: '#ff5e3a', group: 'cardio' },
  'weights-upper': { icon: 'üí™', label: 'Upper Body',   color: '#7c5cff', group: 'weights' },
  'weights-lower': { icon: 'ü¶µ', label: 'Lower Body',   color: '#5ca0ff', group: 'weights' },
  'yoga':          { icon: 'üßò', label: 'Yoga & Stretch',color: '#2dd4a8', group: 'wellness' },
  'wellness':      { icon: 'üß†', label: 'Wellness',     color: '#ffc233', group: 'wellness' },
  'other':         { icon: 'üéØ', label: 'Other',        color: '#e0e0e0', group: 'other' },
};

const LEVELS = [
  { name: 'Beginner',    xp: 0 },
  { name: 'Starter',     xp: 100 },
  { name: 'Active',      xp: 300 },
  { name: 'Committed',   xp: 600 },
  { name: 'Dedicated',   xp: 1000 },
  { name: 'Warrior',     xp: 1500 },
  { name: 'Champion',    xp: 2200 },
  { name: 'Legend',       xp: 3000 },
  { name: 'Mythic',      xp: 4000 },
  { name: 'Transcended', xp: 5500 },
];

const ACHIEVEMENTS = [
  { id: 'first',     icon: 'üåü', name: 'First Step',     desc: 'Log first workout',       check: d => d.activities.length >= 1 },
  { id: 'five',      icon: '‚úã', name: 'High Five',      desc: 'Log 5 workouts',           check: d => d.activities.length >= 5 },
  { id: 'ten',       icon: 'üîü', name: 'Double Digits',  desc: 'Log 10 workouts',          check: d => d.activities.length >= 10 },
  { id: 'twenty5',   icon: 'üèÖ', name: 'Quarter Century', desc: '25 workouts',             check: d => d.activities.length >= 25 },
  { id: 'fifty',     icon: 'üëë', name: 'Half Century',   desc: '50 workouts',              check: d => d.activities.length >= 50 },
  { id: 'hundred',   icon: 'üíé', name: 'Centurion',      desc: '100 workouts',             check: d => d.activities.length >= 100 },
  { id: 'streak3',   icon: 'üî•', name: 'On Fire',        desc: '3-day streak',             check: d => getStreak(d) >= 3 },
  { id: 'streak7',   icon: 'üî•', name: 'Week Warrior',   desc: '7-day streak',             check: d => getStreak(d) >= 7 },
  { id: 'streak14',  icon: 'üî•', name: 'Unstoppable',    desc: '14-day streak',            check: d => getStreak(d) >= 14 },
  { id: 'streak30',  icon: 'üî•', name: 'Iron Will',      desc: '30-day streak',            check: d => getStreak(d) >= 30 },
  { id: 'allcats',   icon: 'üåà', name: 'Well Rounded',   desc: 'Try all categories',       check: d => new Set(d.activities.map(a=>a.category)).size >= 5 },
  { id: 'hour',      icon: '‚è±Ô∏è', name: 'Hour Power',     desc: '60+ min session',          check: d => d.activities.some(a=>a.duration>=60) },
  { id: 'early',     icon: 'üåÖ', name: 'Early Bird',     desc: 'Log before 7 AM',          check: d => d.activities.some(a=> { const h=new Date(a.logged).getHours(); return h<7; }) },
  { id: 'xp500',     icon: '‚ö°', name: 'Powerhouse',     desc: 'Earn 500 XP',              check: d => getTotalXP(d) >= 500 },
  { id: 'xp2000',    icon: '‚ö°', name: 'Electrifying',   desc: 'Earn 2000 XP',             check: d => getTotalXP(d) >= 2000 },
];

function loadData() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (raw) return JSON.parse(raw);
  } catch(e) {}
  return { activities: [], unlockedAchievements: [] };
}

function saveData(data) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ
let data = loadData();
let calYear, calMonth;
let selectedCat = null;
let selectedDuration = null;
let statsPeriod = 'week';

// Init calendar to current month
const now = new Date();
calYear = now.getFullYear();
calMonth = now.getMonth();

// Set default date
document.getElementById('activityDate').value = toDateStr(now);

// ‚îÄ‚îÄ‚îÄ UTILITIES ‚îÄ‚îÄ‚îÄ
function toDateStr(d) {
  const y = d.getFullYear(), m = String(d.getMonth()+1).padStart(2,'0'), day = String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${day}`;
}

function dateKey(d) { return typeof d === 'string' ? d.split('T')[0] : toDateStr(d); }

function getTotalXP(d) {
  return d.activities.reduce((sum, a) => sum + (a.xp || 0), 0);
}

function getStreak(d) {
  if (!d.activities.length) return 0;
  const days = new Set(d.activities.map(a => dateKey(a.date)));
  const sorted = [...days].sort().reverse();
  let streak = 0;
  const today = toDateStr(new Date());
  const yesterday = toDateStr(new Date(Date.now() - 86400000));

  if (!days.has(today) && !days.has(yesterday)) return 0;

  let check = days.has(today) ? new Date() : new Date(Date.now() - 86400000);
  while (days.has(toDateStr(check))) {
    streak++;
    check = new Date(check.getTime() - 86400000);
  }
  return streak;
}

function calcXP(duration) {
  if (duration >= 90) return 50;
  if (duration >= 60) return 40;
  if (duration >= 45) return 30;
  if (duration >= 30) return 20;
  return 10;
}

function getLevel(xp) {
  let lvl = 0;
  for (let i = LEVELS.length - 1; i >= 0; i--) {
    if (xp >= LEVELS[i].xp) { lvl = i; break; }
  }
  const current = LEVELS[lvl];
  const next = LEVELS[lvl + 1] || { xp: current.xp + 1000 };
  const progress = (xp - current.xp) / (next.xp - current.xp);
  return { level: lvl + 1, name: current.name, progress: Math.min(progress, 1), currentXP: xp - current.xp, neededXP: next.xp - current.xp };
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ
function switchView(viewId, btn) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById(viewId).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  if (btn) btn.classList.add('active');
  document.getElementById('viewContainer').scrollTop = 0;

  if (viewId === 'calendarView') renderCalendar();
  if (viewId === 'statsView') renderStats();
  if (viewId === 'achieveView') renderAchievements();
}

// ‚îÄ‚îÄ‚îÄ LOG MODAL ‚îÄ‚îÄ‚îÄ
function openLogModal(cat) {
  document.getElementById('logModal').classList.add('show');
  selectedCat = null;
  selectedDuration = null;
  document.getElementById('activityName').value = '';
  document.getElementById('activityNotes').value = '';
  document.getElementById('activityDate').value = toDateStr(new Date());
  document.querySelectorAll('.modal-cat').forEach(c => c.classList.remove('selected'));
  document.querySelectorAll('.dur-chip').forEach(c => c.classList.remove('selected'));
  document.getElementById('saveBtn').disabled = true;

  if (cat) {
    const btn = document.querySelector(`.modal-cat[data-cat="${cat}"]`);
    if (btn) selectCat(btn);
  }
}

function closeLogModal() {
  document.getElementById('logModal').classList.remove('show');
}

function selectCat(el) {
  document.querySelectorAll('.modal-cat').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  selectedCat = el.dataset.cat;
  validateForm();
}

function selectDuration(el, mins) {
  document.querySelectorAll('.dur-chip').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  selectedDuration = mins;
  validateForm();
}

function validateForm() {
  document.getElementById('saveBtn').disabled = !(selectedCat && selectedDuration);
}

function saveActivity() {
  if (!selectedCat || !selectedDuration) return;

  const xp = calcXP(selectedDuration);
  const activity = {
    id: Date.now().toString(36) + Math.random().toString(36).slice(2,6),
    category: selectedCat,
    name: document.getElementById('activityName').value || CATEGORIES[selectedCat].label,
    duration: selectedDuration,
    date: document.getElementById('activityDate').value,
    notes: document.getElementById('activityNotes').value,
    xp: xp,
    logged: new Date().toISOString(),
  };

  data.activities.push(activity);

  // Check achievements
  const newAchievements = [];
  ACHIEVEMENTS.forEach(a => {
    if (!data.unlockedAchievements.includes(a.id) && a.check(data)) {
      data.unlockedAchievements.push(a.id);
      newAchievements.push(a);
    }
  });

  saveData(data);
  closeLogModal();
  showToast(`+${xp} XP earned! ‚ö°`);

  if (newAchievements.length) {
    setTimeout(() => {
      showToast(`üèÜ Achievement Unlocked: ${newAchievements.map(a=>a.name).join(', ')}`);
    }, 1500);
  }

  updateHeader();
  renderRecent();
}

// ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ
function updateHeader() {
  const xp = getTotalXP(data);
  const streak = getStreak(data);
  document.getElementById('headerXP').textContent = xp + ' XP';
  document.getElementById('headerStreak').textContent = streak;
}

// ‚îÄ‚îÄ‚îÄ RECENT ACTIVITIES ‚îÄ‚îÄ‚îÄ
function renderRecent() {
  const list = document.getElementById('recentList');
  const recent = [...data.activities].reverse().slice(0, 10);

  if (!recent.length) {
    list.innerHTML = '<div class="empty-state"><span class="empty-icon">üèãÔ∏è</span><p>No activities yet. Tap a category above to get started!</p></div>';
    return;
  }

  list.innerHTML = recent.map(a => {
    const cat = CATEGORIES[a.category] || CATEGORIES.other;
    return `<div class="recent-item">
      <div class="recent-icon" style="background:${cat.color}22">${cat.icon}</div>
      <div class="recent-info">
        <div class="recent-title">${a.name}</div>
        <div class="recent-meta">${a.date} ¬∑ ${a.duration} min</div>
      </div>
      <div class="recent-xp">+${a.xp} XP</div>
    </div>`;
  }).join('');
}

// ‚îÄ‚îÄ‚îÄ CALENDAR ‚îÄ‚îÄ‚îÄ
function changeMonth(dir) {
  calMonth += dir;
  if (calMonth < 0) { calMonth = 11; calYear--; }
  if (calMonth > 11) { calMonth = 0; calYear++; }
  renderCalendar();
}

function renderCalendar() {
  const monthNames = ['JANUARY','FEBRUARY','MARCH','APRIL','MAY','JUNE','JULY','AUGUST','SEPTEMBER','OCTOBER','NOVEMBER','DECEMBER'];
  document.getElementById('calMonth').textContent = `${monthNames[calMonth]} ${calYear}`;

  const grid = document.getElementById('calGrid');
  const dayLabels = ['S','M','T','W','T','F','S'];
  let html = dayLabels.map(d => `<div class="cal-day-label">${d}</div>`).join('');

  const firstDay = new Date(calYear, calMonth, 1).getDay();
  const daysInMonth = new Date(calYear, calMonth + 1, 0).getDate();
  const today = toDateStr(new Date());

  // Activity count per day
  const dayCounts = {};
  data.activities.forEach(a => {
    const d = a.date;
    if (d.startsWith(`${calYear}-${String(calMonth+1).padStart(2,'0')}`)) {
      dayCounts[d] = (dayCounts[d] || 0) + 1;
    }
  });

  for (let i = 0; i < firstDay; i++) html += '<div class="cal-day empty"></div>';

  for (let d = 1; d <= daysInMonth; d++) {
    const ds = `${calYear}-${String(calMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const count = dayCounts[ds] || 0;
    let cls = 'cal-day';
    if (ds === today) cls += ' today';
    if (count > 0) {
      cls += ' has-activity';
      if (count >= 4) cls += ' intensity-4';
      else if (count >= 3) cls += ' intensity-3';
      else if (count >= 2) cls += ' intensity-2';
      else cls += ' intensity-1';
    }
    html += `<div class="${cls}" onclick="showDay('${ds}')">${d}</div>`;
  }

  grid.innerHTML = html;
}

function showDay(ds) {
  const acts = data.activities.filter(a => a.date === ds);
  const detail = document.getElementById('dayDetail');

  if (!acts.length) {
    detail.innerHTML = `<div class="empty-state"><span class="empty-icon">üò¥</span><p>No activities on ${ds}</p></div>`;
    return;
  }

  detail.innerHTML = acts.map(a => {
    const cat = CATEGORIES[a.category] || CATEGORIES.other;
    return `<div class="day-activity">
      <div class="day-activity-icon">${cat.icon}</div>
      <div class="day-activity-info">
        <div class="day-activity-name">${a.name}</div>
        <div class="day-activity-meta">${a.duration} min ¬∑ +${a.xp} XP${a.notes ? ' ¬∑ ' + a.notes : ''}</div>
      </div>
      <button class="day-activity-del" onclick="deleteActivity('${a.id}')">‚úï</button>
    </div>`;
  }).join('');
}

function closeDayModal() {
  document.getElementById('dayModal').classList.remove('show');
}

function deleteActivity(id) {
  if (!confirm('Delete this activity?')) return;
  data.activities = data.activities.filter(a => a.id !== id);
  // Re-check achievements (they stay unlocked)
  saveData(data);
  updateHeader();
  renderRecent();
  renderCalendar();
  showToast('Activity deleted');
}

// ‚îÄ‚îÄ‚îÄ STATS ‚îÄ‚îÄ‚îÄ
function setStatsPeriod(period, btn) {
  statsPeriod = period;
  document.querySelectorAll('.period-tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  renderStats();
}

function getFilteredActivities() {
  const now = new Date();
  if (statsPeriod === 'week') {
    const weekAgo = new Date(now.getTime() - 7 * 86400000);
    return data.activities.filter(a => new Date(a.date) >= weekAgo);
  } else if (statsPeriod === 'month') {
    const monthAgo = new Date(now.getTime() - 30 * 86400000);
    return data.activities.filter(a => new Date(a.date) >= monthAgo);
  }
  return [...data.activities];
}

function renderStats() {
  const filtered = getFilteredActivities();
  const totalMin = filtered.reduce((s, a) => s + a.duration, 0);
  const streak = getStreak(data);

  document.getElementById('statWorkouts').textContent = filtered.length;
  document.getElementById('statMinutes').textContent = totalMin;
  document.getElementById('statStreak').textContent = streak;

  // Breakdown
  const catCounts = {};
  Object.keys(CATEGORIES).forEach(k => catCounts[k] = 0);
  filtered.forEach(a => { catCounts[a.category] = (catCounts[a.category] || 0) + 1; });
  const maxCount = Math.max(...Object.values(catCounts), 1);

  const container = document.getElementById('breakdownContainer');
  container.innerHTML = Object.entries(CATEGORIES).map(([key, cat]) => {
    const count = catCounts[key] || 0;
    const pct = (count / maxCount) * 100;
    return `<div class="breakdown-item">
      <div class="breakdown-header">
        <div class="breakdown-label"><span class="breakdown-dot" style="background:${cat.color}"></span>${cat.label}</div>
        <div class="breakdown-count">${count}</div>
      </div>
      <div class="breakdown-bar-bg"><div class="breakdown-bar" style="width:${pct}%;background:${cat.color}"></div></div>
    </div>`;
  }).join('');

  // Focus balance
  const upper = filtered.filter(a => a.category === 'weights-upper').length;
  const lower = filtered.filter(a => a.category === 'weights-lower').length;
  const cardio = filtered.filter(a => a.category === 'cardio').length;
  const wellness = filtered.filter(a => ['yoga','wellness'].includes(a.category)).length;

  document.getElementById('balUpper').textContent = upper;
  document.getElementById('balLower').textContent = lower;
  document.getElementById('balCardio').textContent = cardio;
  document.getElementById('balWellness').textContent = wellness;
}

// ‚îÄ‚îÄ‚îÄ ACHIEVEMENTS ‚îÄ‚îÄ‚îÄ
function renderAchievements() {
  const xp = getTotalXP(data);
  const lvl = getLevel(xp);

  document.getElementById('levelName').textContent = `Level ${lvl.level} ‚Äî ${lvl.name}`;
  document.getElementById('levelXP').textContent = `${lvl.currentXP} / ${lvl.neededXP} XP`;
  document.getElementById('levelBar').style.width = (lvl.progress * 100) + '%';

  const grid = document.getElementById('achievementsGrid');
  grid.innerHTML = ACHIEVEMENTS.map(a => {
    const unlocked = data.unlockedAchievements.includes(a.id);
    return `<div class="achievement ${unlocked ? 'unlocked' : 'locked'}">
      <span class="badge-icon">${a.icon}</span>
      <div class="badge-name">${a.name}</div>
      <div class="badge-desc">${a.desc}</div>
    </div>`;
  }).join('');
}

// ‚îÄ‚îÄ‚îÄ CALENDAR EXPORT ‚îÄ‚îÄ‚îÄ
function exportToCalendar() {
  if (!data.activities.length) { showToast('No activities to export'); return; }

  let ics = 'BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//GRIND//Workout Tracker//EN\nCALSCALE:GREGORIAN\n';

  data.activities.forEach(a => {
    const cat = CATEGORIES[a.category] || CATEGORIES.other;
    const dateClean = a.date.replace(/-/g, '');
    const uid = a.id + '@grind';
    ics += `BEGIN:VEVENT\nDTSTART;VALUE=DATE:${dateClean}\nDTEND;VALUE=DATE:${dateClean}\nSUMMARY:${cat.icon} ${a.name} (${a.duration} min)\nDESCRIPTION:Category: ${cat.label}\\nDuration: ${a.duration} min\\nXP: ${a.xp}${a.notes ? '\\nNotes: ' + a.notes : ''}\nUID:${uid}\nEND:VEVENT\n`;
  });

  ics += 'END:VCALENDAR';

  const blob = new Blob([ics], { type: 'text/calendar' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = 'grind-workouts.ics';
  link.click();
  URL.revokeObjectURL(url);
  showToast('Calendar file downloaded! Open it to import.');
}

// ‚îÄ‚îÄ‚îÄ DATA EXPORT/IMPORT ‚îÄ‚îÄ‚îÄ
function exportData() {
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = 'grind-backup-' + toDateStr(new Date()) + '.json';
  link.click();
  URL.revokeObjectURL(url);
  showToast('Data exported!');
}

function importData() {
  document.getElementById('importFile').click();
}

function handleImport(e) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(ev) {
    try {
      const imported = JSON.parse(ev.target.result);
      if (imported.activities) {
        data = imported;
        saveData(data);
        updateHeader();
        renderRecent();
        showToast('Data imported successfully!');
      } else {
        showToast('Invalid data file');
      }
    } catch(err) {
      showToast('Error reading file');
    }
  };
  reader.readAsText(file);
  e.target.value = '';
}

function clearAllData() {
  if (!confirm('Are you sure you want to delete ALL data? This cannot be undone!')) return;
  data = { activities: [], unlockedAchievements: [] };
  saveData(data);
  updateHeader();
  renderRecent();
  showToast('All data cleared');
}

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
updateHeader();
renderRecent();

// Register service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').catch(() => {});
}
</script>
</body>
</html>
